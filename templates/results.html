{% extends 'base.html' %}
{% block head %}
{% block title %} Results {% endblock %}

{% endblock %}
{% block body %}

<h3>Resulting Melody: </h3>
<audio controls> 
    <source src='{{ melody_file }}' type='audio/wav'> 
</audio><br>
{% if 'user_id' in session and session['user_id'] != None %}
    <h6>Save this melody to your profile: </h6>
    <form action='/add_melody' method='POST'>
        <label for='title'>Title: </label><input type='text' name='title'>
        <input type='submit' value='Submit'>        
    </form>
{% else %}
    <a href='/login'>Login </a>
    or
    <a href='/signup'> Signup </a>
    to save your melody.
{% endif %}

<p>Analysis of Melody: </p>
{% for analyzer, values in analyzer_comparison.iteritems() %}
    <p>{{ analyzer }}: <p>
    <ul>
    {% for features, probability in values.iteritems() %}
        {% if features == (True, False) %}
        <li>Notes only: {{ probability }}</li>
        {% elif features == (False, True) %}
        <li>Steps only: {{ probability }}</li>
        {% elif features == (True, True) %}
        <li>Both notes and steps: {{ probability }}</li>
        {% endif %}
    {% endfor %}
    </ul>
{% endfor %}

<canvas id="myChart" width="400" height="400"></canvas>

<script>
var options = { responsive: true,
                scales: {
                    yAxes: [{
                        ticks: {
                            min: 0.75,
                            max: 1.0,
                            stepSize: 0.05
                        }
                    }]
                } };
                
var ctx = document.getElementById("myChart");
console.log(ctx);

$.get('/analyzer_data.json', function(data) {
    console.log(data);
    var classifier1Chart = new Chart(ctx, {
        type: 'bar',
        data: data,
        options: options,
    });
});

</script>


{% endblock %}